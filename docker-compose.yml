services:
  pinokiod:
    build: 
      context: .
      dockerfile: Docker/Dockerfile
    network_mode: "host"
    # ports:
    #   - "41999:41999"
    environment:
      - HOME=/root
      - PINOKIO_HOME=/root/pinokio
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
      # - LD_LIBRARY_PATH=/usr/local/lib:/usr/lib/x86_64-linux-gnu:/usr/lib
      # - PYTHONPATH=/root/.pinokio/api/fluxgym.git
    restart: unless-stopped
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    volumes:
      - ./Docker/volumes/pinokio:/root/pinokio
      - ./Docker/volumes/pinokio-config:/root/config

